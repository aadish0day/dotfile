##################
# video settings #
##################

# High quality video rendering preset for powerful hardware
profile=high-quality

# Use display-resample for better sync stability
video-sync=display-resample

# Enable hardware decoding - Uses your AMD RX 6700S
hwdec=vaapi

# Copy-back mode for better compatibility with 10-bit content
hwdec-extra-frames=8

# Specify which codecs to use hardware decoding for
hwdec-codecs=all

# Use GPU for video output - stable backend for AMD on Wayland
vo=gpu

# Explicitly use Wayland with Vulkan for best compatibility
gpu-context=waylandvk

# Use Vulkan API (best for AMD on Linux)
gpu-api=vulkan

# High quality scaling algorithms
scale=ewa_lanczossharp
cscale=ewa_lanczossharp
dscale=mitchell

# Disable interpolation by default (enable per-file if needed)
# Prevents desync on lighter content
interpolation=no

# Optimize for your 144Hz display
display-fps-override=144

# Don't allow a new window to have a size larger than 90% of the screen size
autofit-larger=90%x90%

##################
# audio settings #
##################

# Output audio natively (handles your 6ch audio)
audio-channels=auto

# Audio buffer protection against underruns
audio-buffer=0.200
audio-stream-silence=yes

##################
# cache settings #
##################

# Use a large seekable RAM cache (you have 14.85 GiB RAM)
cache=yes

# Optimized cache settings to prevent underruns
demuxer-max-bytes=500M
demuxer-max-back-bytes=128M

# Explicit time-based cache
cache-secs=10

# Disable cache pausing
cache-pause=no

##################
# performance settings #
##################

# Conservative decoder threads for Ryzen 7 6800HS (8 cores/16 threads)
# Reduced from 8 to 4 to leave headroom for audio processing
vd-lavc-threads=4

# Reduce overhead for seeking
hr-seek-framedrop=yes

# AMD GPU specific optimizations
vd-lavc-dr=yes

# Force software rendering for subtitles to prevent sync issues
blend-subtitles=video

##################
# other settings #
##################

# Display English subtitles if available
slang=en

# Prefer English audio
alang=eng,en

# Screenshot settings
screenshot-format=png
screenshot-png-compression=8
screenshot-directory=~/Pictures/mpv-screenshots

# Suppress irrelevant CUDA and Vulkan warnings
msg-level=ffmpeg=error,ffmpeg/video=error
